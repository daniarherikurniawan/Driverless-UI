  <!DOCTYPE html>
  <html lang="en" style="overflow: hidden;">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <title>Sci-Learn</title>
    <meta name="generator" content="Bootply" />
    <link href="../../../<%#page%>../<%/page%>stylesheets/bootstrap.min.css" rel="stylesheet"> 
    <link href="../../../<%#page%>../<%/page%>stylesheets/font-awesome.min.css" rel="stylesheet"> 
        <script src="../../../<%#page%>../<%/page%>javascripts/jquery/jquery.min.js"></script>
        <script src="../../../<%#page%>../<%/page%>javascripts/socket.io/socket.io.js"></script>
        <script src="../../../<%#page%>../<%/page%>javascripts/socket.io/update_socket.js"></script>
        <script src="../../../<%#page%>../<%/page%>javascripts/bootstrap/bootstrap.min.js"></script>
        <script src="../../javascripts/common/common.js"></script>
        <link href="../../../<%#page%>../<%/page%>stylesheets/styles.css" rel="stylesheet">
        <link rel="shortcut icon" type="image/png" href="../../../<%#page%>../<%/page%>images/logo.jpg"/>
      </head>
      <body onload="updateOnlinePanel('<%profile._id%>')">
        <div class="wrapper">
          <div class="box">
            <div class="row row-offcanvas row-offcanvas-left">


              <!-- main right col -->
              <div class="column col-sm-12 col-xs-11" id="main" style="margin-top: 50px; width: 100%; height:95%">
                <!-- top nav -->
                <div class="navbar navbar-blue navbar-static-top">  
                  <%> topNavigation%>
                </div>
                <!-- /top nav -->

                <div class="padding" style="  padding-top: 15px;">

                <div class="row" style="
                    align-content: center;
                    margin-left: auto;
                    margin-right: auto;
                    ">
                  <div class="full col-sm-9" style="padding-top:0px;">

                    <!-- content -->                      
                    <div class="row">

                     <!-- main col left --> 
                     <div class="col-sm-3 leftside">
                        <%> about_user %>
                        <%> list_group %> 
                       </div>
                       <!-- main col left --> 
                       

                       <!-- main col right -->
                       <div class="col-sm-6 middle_display" style="padding-left:0px; padding-right:0px;">
                       <div class="row" style="margin-bottom:-140px; background-size:100%;">
                            
                          <div class="col-sm-12" style="left: 1px; padding: 0 0 0 0 ; ;height:287px;overflow:hidden">
                             <img style=" top:115px;    width: inherit   ; max-width:100%; max-height:100%;  position: absolute; left: 49.7%;
                             -webkit-transform: translateY(-50%) translateX(-50%);  -moz-transform: translateY(-50%) translateX(-50%) ;"src="/images/<%friendProfile.email%><%^friendProfile.name%><%profile.email%><%/friendProfile.name%>/cover/<%friendProfile.img_cover_name%><%^friendProfile.name%><%profile.img_cover_name%><%/friendProfile.name%>">

                              <div class="col-sm-1" style=" top: 155px;left: 18px; padding: 0 0 0 0 ; width:120px;height:120px;overflow:hidden"> <a  href="#photoModal" role="button" data-toggle="modal" > <img style="width:120px;  position: relative; left: 50%; top: 50%; 
                             -webkit-transform: translateY(-50%) translateX(-50%);  -moz-transform: translateY(-50%) translateX(-50%) ;"src="/images/<%friendProfile.email%><%^friendProfile.name%><%profile.email%><%/friendProfile.name%>/profile/<%friendProfile.img_profile_name%><%^friendProfile.name%><%profile.img_profile_name%><%/friendProfile.name%>">
                             </a>
                             </div>
                              
                               <div class="col-sm-9" style="padding-right:0px; margin-bottom:9px; left:3px;top: 251px;">
                                  <div class="panel-heading" style="; padding-right:0px">
                                  
                                  <h3 style="margin: 0px 0px 0px 0px; ">

                                  <a href="/profile/<%friendProfile.email%><%^friendProfile.name%><%profile.email%><%/friendProfile.name%>" > 
                                  <b><%friendProfile.name%><%^friendProfile%><%profile.name%><%/friendProfile%></b></a>'s  
                                  <%#showFriends%> connections<%/showFriends%>
                                  <%^showFriends%><%^showPerActivity%> posts<%/showPerActivity%>
                                  <%#showPerActivity%> activities<%/showPerActivity%><%/showFriends%>

                                  <a id="<%profile._id%>" href="/connections/<%friendProfile._id%><%^friendProfile.name%><%profile._id%><%/friendProfile.name%>" class=" pull-right fa fa-users" style="font-size:15px; margin-top: 6px; <%#showFriends%> color:rgb(45, 99, 99); <%/showFriends%>" > <% friendProfile.connections.length %> <%^friendProfile%><%profile.connections.length%><%/friendProfile%> </a> 
                                  </h3>
                                </div>
                             </div>


                            <%^myFriend%>

                              <div id="<%friendProfile._id%>" class="col-sm-1" style=" top: 99px;left: 34px; padding: 0 0 0 0 ; width:100px;height:35px;overflow:hidden">
                                <button   class="btn btn-primary" onclick="tryToConnect('<%friendProfile._id%>','<%friendProfile.name%>')"><i style="color:white" class="glyphicon glyphicon-plus"></i>&nbspConnect</button>
                             </div>
                             <%/myFriend%>

                             <%#myFriend%>
                                <%#friendProfile%>
                                <div id="<%friendProfile._id%>" class="col-sm-1" style=" top: 98px;left: 7px; padding: 0 0 0 0 ; width:209px;height:86px;overflow:hidden">

                                  <div class="col-sm-1 " style="margin-top: 0px;padding-right: 0px;padding-left: 27px;">

                                  <li class="dropdown" style="list-style-type: none;">
                                    <a href="" data-toggle="dropdown"><i class="btn btn-primary glyphicon glyphicon-cog" style=""></i></a>
                                    <ul class="dropdown-menu" style="left:46px; top:-2px;    min-width: 120px; ">

                                      <li><a class="btn "  style="text-align: left" type="button"><i class="glyphicon glyphicon-eye-close "></i>&nbsp; Unfollow</a></li>
                                      <li><a class="btn" style="text-align: left" href="/Unconnect/<%_id%>/<%email%>" type="button" href=""><i class="glyphicon glyphicon-remove "></i>&nbsp; Unconnect</a></li>
                                     </ul>
                                   </li>
                                 </div>
                               </div>
                               <%/friendProfile%>
                             <%/myFriend%>


                              <%^friendProfile%>
                                <div id="<%friendProfile._id%>" class="col-sm-1" style=" top: 98px;left: 7px; padding: 0 0 0 0 ; width:285px;height:96px;overflow:hidden">

                                  <div class="col-sm-1 " style="margin-top: 0px;padding-right: 0px;padding-left: 27px;">

                                  <li class="dropdown" style="list-style-type: none;">
                                    <a href="" data-toggle="dropdown"><i class="btn btn-primary glyphicon glyphicon-user" style=""></i></a>
                                    <ul class="dropdown-menu" style="left:46px; top:-2px;    min-width: 120px; ">

                                      <li><a style="text-align: left;" class="btn " type="button" onclick="editPostt('<%_id%>','<%profile._id%>')"><i class="glyphicon glyphicon-pencil "></i>&nbsp; Edit profile</a></li>
                                      <li><a style="text-align: left;" class="btn" type="button" href=""><i class="glyphicon glyphicon-remove "></i>&nbsp; Delete account</a></li>
                                      <li ><a style="text-align: left;" class="btn" onclick="tryToGetToken()"  type="button"><i class="fa fa-shield " style="   margin: 0px 2px 0 2px;"></i>&nbsp; Get Token</a></li>
                                     </ul>
                                   </li>
                                 </div>
                               </div>
                               <%/friendProfile%>

                           </div>


                        </div>
                            

              <%friends.name%>
                  <div class="panel panel-default" id="<%_id%>" >
                       <div class="row">
                     <%# showFriends %>
                      <div style="margin: 0px 0px 0px 0px">
                      &nbsp;</div>
                     <%/ showFriends %>
                     <%^ showFriends %>
                        <div class="col-md-7">
                          <div class="row " style="margin-bottom: 3px;">
                            <div class="col-sm-1" style="padding: 11px 0px 11px 0px; margin-top: 10px; left: 20px; ">
                                Institution
                            </div>
                            <div class="col-sm-9" style="padding: 0px 0px 0px 0px;margin-top: 10px; left: 85px;">
                                <p   class="list-group-item"><%friendProfile.education%><%^friendProfile.name%><%profile.education%><%/friendProfile.name%></p>
                            </div>
                          </div>

                          <div class="row " style="margin-bottom: 3px;">
                            <div class="col-sm-1" style="padding: 11px 0px 11px 0px;  left: 20px; ">
                                Occupation
                            </div>
                            <div class="col-sm-9" style="padding: 0px 0px 0px 0px;left: 85px;">
                                <p   class="list-group-item"><%friendProfile.occupation%><%^friendProfile.name%><%profile.occupation%><%/friendProfile.name%></p>
                            </div>
                          </div>

                          <div class="row " style="margin-bottom: 3px;">
                            <div class="col-sm-1" style="padding: 11px 0px 11px 0px;  left: 20px; ">
                                Contact
                            </div>
                            <div class="col-sm-9" style="padding: 0px 0px 0px 0px;left: 85px;">
                               <p   class="list-group-item"><%friendProfile.email%><%^friendProfile.name%><%profile.email%><%/friendProfile.name%></p>
                            </div>
                          </div>

                        </div>

                        <div class="col-md-5" style="margin: 10px 0 0 0 ;padding-left: 20px;">
                          <div class="panel panel-default" style="margin-bottom: 0px">
                          <div  class="text-center panel-heading">
                            <b id="messageStatus" > ACTIVENESS </b>
                          </div>
                         </div>
                         <div class="row" >
                            <div class="col-sm-12" style="padding: 0px 0px 0px 0px; margin-bottom:5px">
                               <p style="height: 89px; padding: 5px;"  class="text-center list-group-item">
                               <b><span  style = "font-size:30px"><%friendProfile.activeness%><%^friendProfile.name%><%profile.activeness%><%/friendProfile.name%></span></b>
                               <br>
                                  <a id="<%profile._id%>"  style="font-size:14px; margin-top: 6px; color:rgb(59, 151, 152);<%#showPost%> color:#2d6363; <%/showPost%>; padding: 12px 5px 4px 5px; " href="/user/post" class="fa fa-newspaper-o" >&nbsp; <%friendProfile.id_user_posts.length%><%^friendProfile.name%><%profile.id_user_posts.length%><%/friendProfile.name%> &nbsp; </a> 
                                  <a id="<%profile._id%>" href="/user/share" class="fa fa-share" style="font-size:14px; margin-top: 6px;color: rgb(59, 151, 152); <%#showShare%> color:#2d6363; <%/showShare%>" >&nbsp; <%friendProfile.id_share_posts.length%><%^friendProfile.name%><%profile.id_share_posts.length%><%/friendProfile.name%> &nbsp; </a> 
                                  <a id="<%profile._id%>" href="/user/like" class="fa fa-thumbs-up" style="font-size:14px; margin-top: 6px;color: rgb(59, 151, 152); <%#showLike%> color:#2d6363; <%/showLike%>" >&nbsp; <%friendProfile.id_liked_posts.length%><%^friendProfile.name%><%profile.id_liked_posts.length%><%/friendProfile.name%> &nbsp; </a> 
                                  <a id="<%profile._id%>" href="/user/comment" class="fa fa-comments-o" style="font-size:14px; margin-top: 6px;color: rgb(59, 151, 152); <%#showComment%> color:#2d6363; <%/showComment%>" >&nbsp; <%friendProfile.id_commented_posts.length%><%^friendProfile.name%><%profile.id_commented_posts.length%><%/friendProfile.name%> </a> 
                              </p>
                            </div>
                        </div>
                          
                        </div>

                     <%/ showFriends %>

                          <div class="text-center" style="<%# showFriends %>margin-top:-13px; <%/ showFriends %> <%^ showFriends %>margin-top:5px; <%/ showFriends %>margin-bottom:1px">
                            <a href="#" class="glyphicon glyphicon-option-horizontal" style="font-size:15px "></a>
                          </div>
                          </div>
            </div>

                   
                 <%> post_partial %>

                 <%> list_user %>


                    <div class="text-center">
                      
                      <div class="row" >
                        <ul class="pagination" id="pagination">
                        </ul>
                      </div>
                      <div id="statePage">
                        <%^friendProfile%>    
                        <%#showFriends%> 
                          Let's   <a href="/search"> <button class=" btn btn-md btn-primary" >Find</button> </a> a new connections !
                        <%/showFriends%>
                        
                        <%^showFriends%>
                          <%^showPerActivity%>Create your <a href="/"> <button class=" btn btn-md btn-primary" > New Post</button> </a> !<%/showPerActivity%>
                          
                          <%#showPerActivity%> Do some activities in your  <a href="/"> <button class=" btn btn-md btn-primary" >Home</button> </a>!
                          <%/showPerActivity%>
                        <%/showFriends%>
                        <%/friendProfile%>   
                      </div>
                      <!-- <hr> -->
                    </div> 
         
              </div>

              <style type="text/css">
                #rightSideBar::-webkit-scrollbar { 
                  display: none; 
              };
              </style>


              <div id="rightSideBar" class="col-sm-3 rightside" style="overflow:auto" >
                 <%> rightSide%> 
              </div>

              </div><!--/row-->

            </div>


          </div><!-- /col-9 -->


        </div><!-- /padding -->
      </div>
      <!-- /main -->

    </div>
  </div>
  </div>
  <script>
  // alert('<%showFriends%><%^showFriends%><%showFriends%><%/showFriends%>'== 'true' )
    str = "";
    var numOfLastPage = <%numOfLastPage%>;
    var numOfCurrPage = <%numOfCurrPage%>+1;

        // alert(<%showFriends%>)
    if(numOfCurrPage <= numOfLastPage){
      limitIndexPage = 10;
      if(numOfLastPage < 10)
        limitIndexPage = numOfLastPage-1;

      firstIndexPage = 1; //numOfLastPage
      if(numOfCurrPage > 5)
        if( numOfCurrPage+5 <= numOfLastPage)
          firstIndexPage = numOfCurrPage-5;
        else 
          firstIndexPage = numOfLastPage - limitIndexPage;

      if('<%showFriends%><%^showFriends%><%showFriends%><%/showFriends%>'== 'true' ){
        // show friends
        //add first page
        str +=  "<li";
        if(1 == numOfCurrPage)
            str += " class=\"active\"";
        str += "><a href=\"/connections/<%friendProfile._id%><%^friendProfile._id%><%profile._id%><%/friendProfile._id%>/"+0+"/<%limitPerPage%>\">"+'First'+"</a></li>";


        //add first intermediate page
        if(numOfLastPage > 11 && 2 < firstIndexPage+1){
          intermediateIndex = Math.ceil(firstIndexPage/2);
          str +=  "<li><a href=\"/connections/<%friendProfile._id%><%^friendProfile._id%><%profile._id%><%/friendProfile._id%>/"+(intermediateIndex)+"/<%limitPerPage%>\">"+"..."+"</a></li>";
        }

        lastIndexPage = firstIndexPage + limitIndexPage - 1;


        for (var i = firstIndexPage + 1; i <= lastIndexPage; i++) {
          str +=  "<li";
          if(i == numOfCurrPage)
            str += " class=\"active\"";
          str += "><a href=\"/connections/<%friendProfile._id%><%^friendProfile._id%><%profile._id%><%/friendProfile._id%>/"+(i-1)+"/<%limitPerPage%>\">"+(i)+"</a></li>";
        };

        //add last intermediate page
        if(numOfLastPage > 11 && (numOfLastPage-1) > lastIndexPage){
          intermediateIndex = Math.floor(lastIndexPage+((numOfLastPage - lastIndexPage) /2)-1);
          str +=  "<li><a href=\"/connections/<%friendProfile._id%><%^friendProfile._id%><%profile._id%><%/friendProfile._id%>/"+(intermediateIndex)+"/<%limitPerPage%>\">"+"..."+"</a></li>";
        }

         //add last page
        if(numOfLastPage > 1){
          str +=  "<li";
          if(numOfLastPage == numOfCurrPage)
              str += " class=\"active\"";
          str += "><a href=\"/connections/<%friendProfile._id%><%^friendProfile._id%><%profile._id%><%/friendProfile._id%>/"+(numOfLastPage-1)+"/<%limitPerPage%>\">"+'Last'+"</a></li>";
        }
      }else if('<%showPerActivity%><%^showPerActivity%><%showPerActivity%><%/showPerActivity%>'== 'true' ){
        //show activity
        //add first page
        str +=  "<li";
        if(1 == numOfCurrPage)
            str += " class=\"active\"";
        str += "><a href=\"/<%urlActivity%>/"+0+"/<%limitPerPage%>\">"+'First'+"</a></li>";

        //add first intermediate page
        if(numOfLastPage > 11 && 2 < firstIndexPage+1){
          intermediateIndex = Math.ceil(firstIndexPage/2);
          str +=  "<li><a href=\"/<%urlActivity%>/"+(intermediateIndex)+"/<%limitPerPage%>\">"+"..."+"</a></li>";
        }

        lastIndexPage = firstIndexPage + limitIndexPage - 1;


        for (var i = firstIndexPage+1; i <= lastIndexPage ; i++) {
          str +=  "<li";
          if(i == numOfCurrPage)
            str += " class=\"active\"";
          str += "><a href=\"/<%urlActivity%>/"+(i-1)+"/<%limitPerPage%>\">"+(i)+"</a></li>";
        };  
        
        //add last intermediate page
        if(numOfLastPage > 11 && (numOfLastPage-1) > lastIndexPage){
          intermediateIndex = Math.floor(lastIndexPage+((numOfLastPage - lastIndexPage) /2)-1);
          str +=  "<li><a href=\"/<%urlActivity%>/"+(intermediateIndex)+"/<%limitPerPage%>\">"+"..."+"</a></li>";
        }
        
         //add last page
        if(numOfLastPage > 1){
          str +=  "<li";
          if(numOfLastPage == numOfCurrPage)
              str += " class=\"active\"";
          str += "><a href=\"/<%urlActivity%>/"+(numOfLastPage-1)+"/<%limitPerPage%>\">"+'Last'+"</a></li>";
        }
        // alert("hhhhh")
      }else{
        // show profile
        //add first page
        str +=  "<li";
        if(1 == numOfCurrPage)
            str += " class=\"active\"";
        str += "><a href=\"/profile/<%friendProfile.email%><%^friendProfile._id%><%profile.email%><%/friendProfile._id%>/"+0+"/<%limitPerPage%>\">"+'First'+"</a></li>";

        //add first intermediate page
        if(numOfLastPage > 11 && 2 < firstIndexPage+1){
          intermediateIndex = Math.ceil(firstIndexPage/2);
          str +=  "<li><a href=\"/profile/<%friendProfile.email%><%^friendProfile._id%><%profile.email%><%/friendProfile._id%>/"+(intermediateIndex)+"/<%limitPerPage%>\">"+"..."+"</a></li>";
        }

        lastIndexPage = firstIndexPage + limitIndexPage - 1;


        for (var i = firstIndexPage+1; i <= lastIndexPage ; i++) {
          str +=  "<li";
          if(i == numOfCurrPage)
            str += " class=\"active\"";
          str += "><a href=\"/profile/<%friendProfile.email%><%^friendProfile._id%><%profile.email%><%/friendProfile._id%>/"+(i-1)+"/<%limitPerPage%>\">"+(i)+"</a></li>";
        };  
        
        //add last intermediate page
        if(numOfLastPage > 11 && (numOfLastPage-1) > lastIndexPage){
          intermediateIndex = Math.floor(lastIndexPage+((numOfLastPage - lastIndexPage) /2)-1);
          str +=  "<li><a href=\"/profile/<%friendProfile.email%><%^friendProfile._id%><%profile.email%><%/friendProfile._id%>/"+(intermediateIndex)+"/<%limitPerPage%>\">"+"..."+"</a></li>";
        }
        
         //add last page
        if(numOfLastPage > 1){
          str +=  "<li";
          if(numOfLastPage == numOfCurrPage)
              str += " class=\"active\"";
          str += "><a href=\"/profile/<%friendProfile.email%><%^friendProfile._id%><%profile.email%><%/friendProfile._id%>/"+(numOfLastPage-1)+"/<%limitPerPage%>\">"+'Last'+"</a></li>";
        }

        document.getElementById("pagination").innerHTML = str;
      }

        lastResult = 0;
        if(numOfCurrPage==numOfLastPage){
          lastResult = '<%numOfPost%><%numOfFriend%>';
        }
        else
          lastResult = (numOfCurrPage*<%limitPerPage%>);

        
        document.getElementById("statePage").innerHTML = "Showing "+(<%numOfCurrPage%>*<%limitPerPage%>+1)+" - "+lastResult+" results<p><b>Page "+numOfCurrPage+" of "+numOfLastPage+"<b></p>";
    }
  </script>


<!--share modal-->
<%> share_modal%>
<!--edit_post_template-->
<%> edit_post_template%>

  <!--photo modal-->
  <div id="photoModal" class="modal fade" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content" style="width:70%; left:15%">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
          <b><h4> <%friendProfile.name%><%^friendProfile.name%><%profile.name%><%/friendProfile.name%></h4></b>
        </div>
        <div class="modal-body">
          <div class="panel panel-default" style="margin-bottom:0px">
            <div class="panel-thumbnail">

              <a href="#photoModal" role="button" data-toggle="modal"><img src="/images/<%friendProfile.email%><%^friendProfile.name%><%profile.email%><%/friendProfile.name%>/profile/<%friendProfile.img_profile_name%><%^friendProfile.name%><%profile.img_profile_name%><%/friendProfile.name%>"width="100%" class="img-responsive" ></a>
            </div>
          </div>
        </div>

        <%^ friendProfile.name%>
        <div class="modal-footer" style="padding-left: 25px; padding-right: 20px; padding-bottom: 0px;">
          <button class="btn btn-primary btn-sm" data-dismiss="modal" aria-hidden="true" > <span class="glyphicon glyphicon-trash" ></span>&nbsp;&nbspDelete</button>
          <button class="btn btn-primary btn-sm" data-dismiss="modal" aria-hidden="true" onClick="triggermyNewProfilePicture()" > <span class="glyphicon glyphicon-folder-open " ></span>&nbsp;&nbspUpload</button>

          <ul class="pull-left list-inline" ><li>
            <a href=""><i class="glyphicon glyphicon-thumbs-up" style="color:rgb(45, 99, 99); font-size: 25px;"></i></a></li><li>
            <a href=""><i class="glyphicon glyphicon-comment" style="color:rgb(45, 99, 99); font-size: 25px;"></i></a></li><li>
          </ul>
          <ul class="pull-right list-inline"><li>

            <form name="upload" id="submitPicture" method="post" action="/upload_img_profile"  enctype="multipart/form-data" style="width:0px" >
              <input style="visibility:hidden"  onchange="submitForm()" name= "img_profile" type="file" id="myNewProfilePicture">
            </form>

          </ul>       

        </div>

        <%/ friendProfile.name%>


      </div>
    </div>
  </div>


  </body>
  </html>
<!-- script references -->
<script src="../../../<%#page%>../<%/page%>javascripts/page_scripting/profile/profile_script.js"></script>
<script type="text/javascript">
  var myEmail = '<%profile.email%>'
  var id_creator = '<%profile._id%>';
</script>

